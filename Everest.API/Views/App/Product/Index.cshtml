@using Everest.API
@using Everest.Domain
@using Incoding.Core
@using Incoding.Core.CQRS
@using Incoding.Web.CQRS.Common.Command
@using Incoding.Web.Extensions

@{
    Layout = "~/Views/Shared/_Layout.cshtml";
    var cartItems = Html.Dispatcher().Query(new GetCartItemsByCurrentUserQuery()).ToList();
    int numberOfItems = cartItems.Count;
}
@section Body {
    <div class="body d-flex-column gap-1">
        <h1>
            @DataResource.Product
        </h1>
        <div>
            @(Html.When(JqueryBind.KeyUp)
                .Ajax(Url.Dispatcher().Query(new GetProductQuery()).AsJson().AppendToQueryString(new { Search = Selector.Jquery.Self() }))
                .OnSuccess(dsl => { dsl.WithId("products").Insert.WithTemplateByView("~/Views/App/Product/Tmpl.cshtml").Html(); })
                .AsHtmlAttributes(new { placeholder = @DataResource.Search })
                .ToInput(HtmlInputType.Text, String.Empty))
            <div>
                @(Html.When(JqueryBind.InitIncoding)
                    .Ajax(new GetProductQuery())
                    .OnSuccess(dsl => dsl.Self().Insert.WithTemplateByView("~/Views/App/Product/Tmpl.cshtml").Html())
                    .AsHtmlAttributes(new { @class = "d-flex gap-1 padding-05 overflow-x-hidden", id = "products" })
                    .ToDiv())
            </div>
        </div>
        <div class="d-flex gap-1 flex-shrink-0 bg-transparent">
            </div>
    </div>

}

